<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<title>6. ÁLLOMÁS: A LEÁNYVÁR LEGENDÁJA</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
    font-family: 'Georgia', serif;
    background: url('images/jvár.jpg') center/cover no-repeat fixed;
    margin: 0;
    padding: 0;
    color: #f5f2e9;
}

.container {
    max-width: 750px;
    margin: auto;
    background: rgba(0,0,0,0.68);
    padding: 35px;
    border-radius: 12px;
    margin-top: 30px;
    box-shadow: 0 0 25px rgba(0,0,0,0.6);
}

/* Díszes kezdőbetűk */
.initial {
    font-size: 48px;
    font-weight: bold;
    color: #ffd98a;
    float: left;
    margin-right: 8px;
    line-height: 0.85;
    font-family: "Georgia", serif;
    text-shadow: 0 2px 15px rgba(255,215,150,0.6);
}

p {
    line-height: 1.65;
    margin-bottom: 18px;
    font-size: 19px;
}

/* Cím */
h1 {
    text-align:center;
    color:#ffe7a3;
    margin-bottom: 25px;
}

/* Távolság doboz */
.distance-box {
    margin: 10px 0 25px 0;
    padding: 12px 16px;
    border-radius: 8px;
    background: rgba(0, 0, 0, 0.35);
    font-size: 16px;
    text-align: center;
}
.distance-box button {
    font-family: inherit;
    font-size: 16px;
    padding: 8px 14px;
    border-radius: 6px;
    border: none;
    cursor: pointer;
    background: #ffe7a3;
    color: #2b1b0c;
    margin-bottom: 8px;
}
.distance-box button:active {
    transform: scale(0.98);
}
.distance-status {
    display: block;
    margin-top: 4px;
    font-size: 15px;
}

/* gombsor */
.btn-row {
    text-align: center;
    margin-top: 10px;
}

/* Navigációs gomb – égkék, lentre */
.nav-btn {
    display: inline-block;
    margin: 6px 4px;
    padding: 9px 18px;
    background: #68c7ff;
    color: #033048;
    font-weight: bold;
    border-radius: 8px;
    text-decoration: none;
    box-shadow: 0 0 10px rgba(0,0,0,0.5);
    font-size: 15px;
}
.nav-btn:hover {
    filter: brightness(1.05);
}

/* Főoldal gomb */
.home {
    display:inline-block;
    margin-top:12px;
    padding:12px 20px;
    background:#ffe7a3;
    color:#333;
    font-weight:bold;
    border-radius:8px;
    text-decoration:none;
    box-shadow:0 0 10px rgba(255,231,163,0.5);
    font-size:16px;
}
.home:hover {
    filter: brightness(1.05);
}

/* Mobil finomhangolás */
@media (max-width: 480px) {
    .container {
        margin-top: 15px;
        padding: 22px;
    }
    p { font-size: 17px; }
    h1 { font-size: 26px; }
}
</style>
</head>

<body>

<div class="container">

<h1>6. ÁLLOMÁS: A LEÁNYVÁR LEGENDÁJA</h1>

<!-- TÁVOLSÁGMÉRÉS -->
<div class="distance-box">
    <button id="startNavBtn">Távolság mérése (GPS)</button>
    <span id="distanceText" class="distance-status">
        Engedélyezd a helymeghatározást a böngészőben.
    </span>
</div>

<div class="btn-row">
    <a href="https://maps.app.goo.gl/Gbgae78CLL6fsxVz8"
       target="_blank"
       class="nav-btn">
        📍 Útvonal a Leányvárhoz
    </a>
</div>

<p style="font-style: italic; text-align: center; margin-bottom: 25px;">
Miután megcsodáltátok a körkilátást a Leányvár tövéből, fejtsétek meg a mi kis saját költésű balladánkat, mely a Leányvár igazi legendáját meséli el!
</p>

<p><span class="initial">B</span>ús akasztófa állt e hegyen, s a dúsgazdag úrnő a palotájából látta, miként vetül a halál árnya a városra; útálta e látványt a dölyfös leány, s elhatározta: bármi áron de megszabadul tőle.</p>

<p><span class="initial">O</span>ly sokat kérlelte a város tanácsát, hogy az akasztófát állítsák máshová, ám minden hiába volt. Végül rászedte a várost: védelmező várat ajánlott saját vagyonából, ámde a várat pontosan az akasztófa hegyére építtette fel – s a csúf látvány többé nem árnyékolta fényűző napjait.</p>

<p><span class="initial">R</span>agyogóan szép és dúsgazdag leány volt, de csak magával gondolt. A nép azt suttogta, annyi aranypénzt halmozott kamarájába, hogy ha az aranyat az országútra sorakoztatnák, Selmecről Budáig érne a sor….</p>

<p><span class="initial">B</span>ár sok-sok kérője akadt, Ő elhatározta, hogy szégyenszemre sosem megy férjhez; leány maradt, s napjait fényűző dorbézolással töltötte újdonsült várában a hegytetőn. Ezért úgy nevezték a jó selmeciek, hogy „leányvári boszorkány".</p>

<p><span class="initial">Á</span>m figyelmeztették, hogy hatalmas vagyonát eltékozolja, de ő azzal kérkedett, hogy vagyona olyan biztosan megmarad, mint ahogy a gyűrűje elvész – s a legenda szerint e szavakkal gyűrűjét a Selmec patakba hajította.</p>

<p><span class="initial">L</span>egott tévedett a dölyfös úrnő: gyűrűjét egy hal gyomrából vették ki a halászok, s a leányvári boszorkány koldus-szegényen halt meg; temetésén forgószél támadt, koporsóját fejvesztve hagyták magára, s holtteste farkasok martalékává lett…. Azóta a hegyek mélyén a csend titokként őrzi nevét a leányvári boszorkánynak.</p>

<p><span class="initial">A</span>ki figyelmesen olvassa e sorokat, megfejtheti a nevet, mely örök titokként rejti a vár építőjének legendás alakját.</p>

<p style="margin-top: 30px; text-align: center; font-size: 18px; color: #ffe7a3;">
Fejtsétek meg a balladát, és a kulccsal megtudjátok, mi a következő célállomásotok…
</p>

<!-- NAVIGÁCIÓ – LENT KÉKKEL -->

<!-- FŐOLDAL GOMB -->

<!-- KÓD BEKÉRŐ BLOKK (content5 -> content6) -->
<style>
.codegate-container{
  max-width:600px;
  margin:24px auto 10px auto;
  background:rgba(0,0,0,0.70);
  padding:18px 18px 18px 18px;
  border-radius:14px;
  box-shadow:0 0 20px rgba(0,0,0,0.7);
}
.codegate-container h2{
  font-size:22px;
  margin:0 0 10px 0;
  text-align:center;
  color:#ffe7a3;
}
.codegate-container p{
  font-size:18px;
  line-height:1.6;
  text-align:center;
  margin:0 0 12px 0;
}
.codegate-container input[type="text"]{
  width:100%;
  padding:10px 12px;
  margin-top:4px;
  font-size:18px;
  border-radius:8px;
  border:none;
  box-sizing:border-box;
}
.codegate-btn{
  display:block;
  width:100%;
  padding:12px 16px;
  margin-top:12px;
  font-size:18px;
  font-weight:bold;
  font-family:inherit;
  text-align:center;
  border-radius:10px;
  border:none;
  cursor:pointer;
  background:#ffe7a3;
  color:#333;
  box-shadow:0 0 10px rgba(0,0,0,0.6);
}
.codegate-btn:active{ transform:scale(0.98); }
#codegate_error{
  margin-top:10px;
  font-size:15px;
  color:#ffb3b3;
  text-align:center;
}
</style>

<div class="codegate-container">
  <h2>🔐 Rejtvény</h2>
  <p style="font-size: 17px; line-height: 1.6;">
    Ha tudjátok mi a leányvári boszorkány neve (amely a bekezdések első betűiből olvasható ki), akkor tovább juthattok.
  </p>
  <input id="codegate_code" type="text" autocomplete="off" placeholder="Írd ide a nevet">
  <button class="codegate-btn" type="button" onclick="codegate_check()">➜ Tovább</button>
  <div id="codegate_error"></div>
</div>

<script>
(function(){
  function normHu(s){
    if(!s) return "";
    s = String(s).trim().toLowerCase();
    try { s = s.normalize("NFD").replace(/[\u0300-\u036f]/g,""); } catch(e){}
    return s;
  }
  window.codegate_check = function(){
    var v = normHu(document.getElementById("codegate_code").value);
    // helyes megoldás: BORBÁLA
    if (v === "borbala") {
      document.getElementById("codegate_error").innerHTML =
        '<div style="color: #90EE90; font-size: 16px; margin-top: 15px; line-height: 1.6;">' +
        '✅ Megfejtettétek!<br><br>' +
        'Kinyílt az ajtó a következő célállomás felé…<br><br>' +
        'Borbála várának, a Leányvárnak a hivatalos neve: Újvár. Ez ma még fontos lesz! 😊<br><br>' +
        'Most sétáljatok lefelé: a Leányvár alatt megtaláljátok a régi Városkaput. Azon keresztül érkezzetek a városba, mint a hajdani utazók…. és sétáljatok végig a főterén, sorban a következő állomásotokhoz. A séta közben megszámlálhatatlan szépség és középkori kincs kísér benneteket, melyeket megismerni visszavár Benneteket Selmecbánya…….' +
        '</div>';

      // nincs automatikus továbbirányítás – csak a gombbal
      const btn = document.querySelector(".codegate-btn");
      btn.textContent = "➜ Tovább";
      btn.onclick = function() { window.location.href = "content7.html"; };

      document.getElementById("codegate_code").style.display = "none";
      document.getElementById("codegate_error").style.color = "";
    } else {
      document.getElementById("codegate_error").textContent =
        "Ez most nem a helyes válasz. Figyeljétek meg a bekezdések első betűit!";
    }
  };
})();
</script>
<!-- /KÓD BEKÉRŐ BLOKK -->

<div class="btn-row">
    <a href="index.html" class="home">⬅ Főoldal</a>
</div>

</div>

<script>
// Újvár – távolságmérés célpontja
const targetLat = 48.45588159857155;
const targetLon = 18.896004229805616;

const startBtn = document.getElementById("startNavBtn");
const distanceText = document.getElementById("distanceText");
let watchId = null;

// Haversine távolság méterben
function distanceMeters(lat1, lon1, lat2, lon2) {
    const R = 6371000;
    const toRad = x => x * Math.PI / 180;
    const dLat = toRad(lat2 - lat1);
    const dLon = toRad(lon2 - lon1);
    const a =
        Math.sin(dLat / 2) * Math.sin(dLat / 2) +
        Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) *
        Math.sin(dLon / 2) * Math.sin(dLon / 2);
    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
    return R * c;
}

function formatDistance(m) {
    if (m < 5) return "Nagyjából az Újvárnál vagytok.";
    if (m < 1000) return m.toFixed(0) + " méter";
    return (m / 1000).toFixed(2) + " km";
}

function onPosition(pos) {
    const lat = pos.coords.latitude;
    const lon = pos.coords.longitude;
    const dist = distanceMeters(lat, lon, targetLat, targetLon);
    distanceText.textContent =
        "Jelenlegi távolság az Újvártól: " + formatDistance(dist);
}

function onError(err) {
    distanceText.textContent =
        "Nem sikerült lekérni a helyzetet. Ellenőrizd a GPS és a jogosultság beállításait.";
}

startBtn.addEventListener("click", function () {
    if (!("geolocation" in navigator)) {
        distanceText.textContent =
            "A böngésző nem támogatja a helymeghatározást.";
        return;
    }

    if (watchId !== null) {
        navigator.geolocation.clearWatch(watchId);
        watchId = null;
        distanceText.textContent = "A távolságmérés szünetel.";
        startBtn.textContent = "Távolság mérése (GPS)";
        return;
    }

    distanceText.textContent = "Helyzet lekérése...";
    startBtn.textContent = "Mérés leállítása";

    watchId = navigator.geolocation.watchPosition(onPosition, onError, {
        enableHighAccuracy: true,
        maximumAge: 5000,
        timeout: 10000
    });
});
</script>

</body>
</html>
